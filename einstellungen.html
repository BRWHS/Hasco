<!DOCTYPE html>

<html lang="de">
<head>
<meta charset="utf-8"/>
<title>Einstellungen | Hasco</title>
<style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
      color: #212529;
    }
    header {
      background: linear-gradient(to bottom, #343a40 0%, #495057 70%, #f8f9fa 100%);
      padding: 40px 30px 100px 30px;
      position: relative;
    }
    header img {
      width: 260px;
      display: block;
      margin-left: 0;
    }
    .datetime-bar {
      position: absolute;
      top: 40px;
      right: 30px;
      background-color: #ffffffdd;
      color: #212529;
      font-size: 1.2em;
      padding: 10px 16px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      font-weight: 500;
    }
    main {
      padding: 60px 40px;
      max-width: 900px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 25px;
    }
    .card {
      background-color: white;
      padding: 30px 20px;
      border-radius: 16px;
      box-shadow: 0 12px 24px rgba(0,0,0,0.08);
      text-align: center;
      transition: transform 0.2s, background 0.2s;
      cursor: pointer;
    }
    .card:hover {
      transform: translateY(-6px);
      background-color: #f1f3f5;
    }
    .card a {
      text-decoration: none;
      color: #212529;
      font-weight: 600;
      font-size: 1.2em;
      display: block;
    }
    .card a:visited {
      color: inherit;
    }
    .quick-tools {
      position: fixed;
      top: 180px;
      right: 30px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 1000;
    }
    .quick-tools a {
      background-color: #ffffff;
      color: #212529;
      padding: 12px 16px;
      text-decoration: none;
      border-radius: 10px;
      font-size: 14px;
      font-weight: bold;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      transition: background 0.2s;
      text-align: center;
    }
    .quick-tools a:hover {
      background-color: #e9ecef;
    }

@media (max-width: 768px) {
  header {
    padding: 30px 20px 80px 20px;
  }
  header img {
    width: 200px;
  }
  .datetime-bar {
    font-size: 1em;
    top: 20px;
    padding: 8px 12px;
  }
  main {
    padding: 40px 20px;
    grid-template-columns: 1fr;
  }
  .card {
    padding: 24px 16px;
  }
  .quick-tools {
    top: auto;
    bottom: 20px;
    right: 20px;
    flex-direction: column;
  }
}

</style>
</head>
<body>
<a href="index.html" style="
  display: inline-block;
  padding: 8px 16px;
  background-color: #ddd;
  color: black;
  text-decoration: none;
  border-radius: 6px;
  font-size: 14px;
  margin-bottom: 20px;
  font-weight: normal;
">‚Üê Zur√ºck</a>
<h1>Einstellungen</h1>
<div class="search">
<input id="searchInput" placeholder="üîç Nach Gastname suchen..." type="text"/>
</div>

<div class="pagination">
</div>
<script>
    let eintraege = [];
    let gefiltert = [];
    let seite = 1;
    const proSeite = 50;

    async function ladeReservierungen() {
      try {
        const res = await fetch('https://tqivbegnjwschwgrkqfm.supabase.co/rest/v1/bookings?select=*', {
          headers: {
            apikey: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRxaXZiZWduandzY2h3Z3JrcWZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgzNDUxMTUsImV4cCI6MjA2MzkyMTExNX0.WidRDEm8ATqtXW8QcUs_biK_gYdZebpnPyw0PWQ1qKw',
            Authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRxaXZiZWduandzY2h3Z3JrcWZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgzNDUxMTUsImV4cCI6MjA2MzkyMTExNX0.WidRDEm8ATqtXW8QcUs_biK_gYdZebpnPyw0PWQ1qKw'
          }
        });
        eintraege = await res.json();
        gefiltert = eintraege;
        zeigeSeite();
      } catch (error) {
        document.getElementById("reservierungsliste").innerHTML = '<p>Fehler beim Laden der Daten.</p>';
        console.error("Ladefehler:", error);
      }
    }

    function zeigeSeite() {
      const start = (seite - 1) * proSeite;
      const ende = start + proSeite;
      const seiteEintraege = gefiltert.slice(start, ende);

      document.getElementById("reservierungsliste").innerHTML = seiteEintraege.map((e, i) => {
        return `
        <div class="entry" onclick="toggleExpand(this)">
          <span class="hotel">üè® ${e.hotel_name}</span>
          <span>${e.guest_last_name}</span>
          <span>${e.arrival}</span>
          <span>${e.departure}</span>
          <span>${e.category || ''}</span>
          <span>${e.rate_name}</span>
          <span>${e.rate_price}</span>
          <span>${e.notes || ''}</span>
          <div class="details">
            <div class="gast-name">üë§ ${e.guest_first_name || ''} ${e.guest_last_name}</div>
            <div class="hotel-sub">üè® ${e.hotel_name}</div>
            <div class="details-header">
              <div><strong>Anreise:</strong> ${e.arrival}</div>
              <div><strong>Abreise:</strong> ${e.departure}</div>
              <div><strong>Kategorie:</strong> ${e.category || ''}</div>
              <div><strong>Rate:</strong> ${e.rate_name} ‚Äì ${e.rate_price}</div>
              <div><strong>Notes:</strong> ${e.notes || ''}</div>
            </div>
            <div class="details-grid">
              <div><strong>Vorname:</strong> ${e.guest_first_name || ''}</div>
              <div><strong>E-Mail:</strong> ${e.email || ''}</div>
              <div><strong>Telefon:</strong> ${e.phone || ''}</div>
              <div><strong>Best√§tigungsmail:</strong> ${e.confirmation_email || ''}</div>
              <div><strong>Kreditkarte:</strong> ${e.cc_number || ''}</div>
              <div><strong>Ablaufdatum:</strong> ${e.cc_expiry || ''}</div>
            </div>
            <div class="buttons">
              <button class="anpassen" onclick="event.stopPropagation(); anpassen(${e.id})">Reservierung anpassen</button>
              <button class="stornieren" onclick="event.stopPropagation(); stornieren(${e.id})">Reservierung stornieren</button>
            </div>
          </div>
        </div>
      `;
      }).join('');

      document.getElementById("prevPage").disabled = seite === 1;
      document.getElementById("nextPage").disabled = ende >= gefiltert.length;
    }

    function toggleExpand(el) {
      el.classList.toggle("expanded");
    }

    function anpassen(id) {
      console.log("Anpassen von Reservierung:", id);
      alert("Reservierung anpassen f√ºr ID " + id + " (folgt bald)");
    }

    function stornieren(id) {
      console.log("Stornieren von Reservierung:", id);
      alert("Reservierung stornieren f√ºr ID " + id + " (folgt mit Richtlinie)");
    }

    function changePage(delta) {
      seite += delta;
      zeigeSeite();
    }

    function filterList() {
      const q = document.getElementById("searchInput").value.toLowerCase();
      gefiltert = eintraege.filter(e => e.guest_last_name?.toLowerCase().includes(q));
      seite = 1;
      zeigeSeite();
    }

    document.getElementById("searchInput").addEventListener("input", filterList);
    document.getElementById("prevPage").addEventListener("click", () => changePage(-1));
    document.getElementById("nextPage").addEventListener("click", () => changePage(1));

    ladeReservierungen();
  </script>
<div style="max-width: 600px; margin: 60px auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); text-align: center;">
<p style="font-size: 1.2em;">‚öôÔ∏è Hier kannst du bald Einstellungen vornehmen.<br/><br/>Beispiele: API-Schl√ºssel, Nutzerverwaltung, Rechte, Stammdaten</p>
</div>
</body>
</html>
